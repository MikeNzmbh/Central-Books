import{r as d,j as e,c as j,R as N}from"./index-D3o6HobJ.js";function w(t){const s=typeof t=="number"?t:Number(t||0),n=s<0?"-":"",l=Math.abs(s).toFixed(2);return`${n}$${l}`}function v(t){switch(t){case"OK":return e.jsxs("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-0.5 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100",children:[e.jsx("span",{className:"mr-1 h-1.5 w-1.5 rounded-full bg-emerald-500"}),"Feed healthy"]});case"ACTION_NEEDED":return e.jsxs("span",{className:"inline-flex items-center rounded-full bg-amber-50 px-2.5 py-0.5 text-[11px] font-medium text-amber-800 ring-1 ring-amber-100",children:[e.jsx("span",{className:"mr-1 h-1.5 w-1.5 rounded-full bg-amber-500"}),"Review ",e.jsx("span",{className:"underline decoration-dotted",children:"new items"})]});case"DISCONNECTED":return e.jsxs("span",{className:"inline-flex items-center rounded-full bg-rose-50 px-2.5 py-0.5 text-[11px] font-medium text-rose-700 ring-1 ring-rose-100",children:[e.jsx("span",{className:"mr-1 h-1.5 w-1.5 rounded-full bg-rose-500"}),"Connection paused"]});default:return null}}const k=({bank:t})=>{const s=(t||"?").charAt(0).toUpperCase();return e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-2xl bg-slate-900 text-xs font-semibold text-white shadow-sm",children:s})},y=({account:t,importUrl:s,reviewUrl:n})=>{const l=t.lastImportAt?new Date(t.lastImportAt).toLocaleString():"No imports yet";return e.jsxs("div",{className:"flex items-start justify-between gap-4 rounded-2xl border border-slate-100 bg-white px-4 py-3 shadow-sm transition hover:border-sky-100 hover:shadow-md",children:[e.jsxs("div",{className:"flex min-w-0 flex-1 items-start gap-3",children:[e.jsx(k,{bank:t.bank}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("p",{className:"truncate text-sm font-semibold text-slate-900",children:[t.name," ",e.jsxs("span",{className:"text-xs text-slate-500",children:["•••• ",t.last4]})]}),v(t.feedStatus)]}),e.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:t.ledgerLinked?"Linked to ledger asset account":"Not linked to the ledger yet (optional in v1)."}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-3 text-[11px] text-slate-500",children:[e.jsxs("span",{children:[e.jsx("span",{className:"font-medium text-slate-600",children:"Last import:"})," ",l]}),e.jsx("span",{className:"hidden sm:inline","aria-hidden":"true",children:"•"}),e.jsxs("span",{children:[e.jsx("span",{className:"font-medium text-slate-600",children:"Feed items:"})," ",t.newCount," New · ",t.createdCount," Created · ",t.matchedCount," Matched"]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("a",{href:s,className:"inline-flex items-center rounded-full bg-white px-3 py-1.5 text-[11px] font-semibold text-slate-700 ring-1 ring-slate-200 shadow-sm hover:bg-slate-50",children:"Import CSV"}),e.jsx("a",{href:n,className:"inline-flex items-center rounded-full bg-sky-600 px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-sky-700",children:"Review transactions"})]})]})]}),e.jsxs("div",{className:"pt-1 text-right",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-[0.18em] text-slate-400",children:"Ledger balance"}),e.jsxs("div",{className:"mt-0.5 text-sm font-semibold text-slate-900",children:[w(t.ledgerBalance)," ",t.currency]})]})]})},_=({summary:t})=>{const s=(t==null?void 0:t.new_to_review)??0,n=(t==null?void 0:t.created_from_feed)??0,l=(t==null?void 0:t.matched_to_invoices)??0,x=(t==null?void 0:t.reconciled_percent)??100;return e.jsxs("section",{className:"rounded-3xl bg-white px-6 py-5 text-sm text-slate-700 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-[0.16em] text-slate-500",children:"Bank feed snapshot"}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:"All connected bank accounts are kept in sync with your ledger. Once you import statements and review transactions, Mini-Books keeps your cash, Profit & Loss, and tax summaries aligned automatically."})]}),e.jsxs("div",{className:"rounded-full bg-emerald-50 px-3 py-1 text-[11px] font-medium text-emerald-700 ring-1 ring-emerald-100",children:[x,"% of items reconciled"]})]}),e.jsxs("div",{className:"mt-4 grid gap-3 text-[11px] sm:grid-cols-3",children:[e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-3 py-2",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-[0.16em] text-slate-400",children:"New to review"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:s}),e.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Spread across your connected accounts."})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-3 py-2",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-[0.16em] text-slate-400",children:"Created from feed"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:n}),e.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Expenses & income posted this week."})]}),e.jsxs("div",{className:"rounded-2xl bg-slate-50 px-3 py-2",children:[e.jsx("div",{className:"text-[10px] uppercase tracking-[0.16em] text-slate-400",children:"Matched to invoices"}),e.jsx("div",{className:"mt-1 text-lg font-semibold text-slate-900",children:l}),e.jsx("p",{className:"mt-0.5 text-[11px] text-slate-500",children:"Payments matched to open invoices."})]})]})]})},C=()=>e.jsxs("section",{className:"rounded-3xl bg-white px-6 py-5 text-sm text-slate-700 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100",children:[e.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-[0.16em] text-slate-500",children:"Coming soon"}),e.jsx("p",{className:"text-xs leading-relaxed text-slate-600",children:"Future updates will add live bank connections, reconciliation checklists, and smart alerts for unmatched items so you can keep every dollar in sync without manual uploads."}),e.jsx("div",{className:"mt-3 rounded-2xl bg-slate-50 px-3 py-2 text-[11px] text-slate-500",children:"You get the same bank feed engine as the big tools, but with a calmer, Mini-Books-first workflow."})]}),S=()=>e.jsxs("section",{className:"rounded-3xl bg-white px-6 py-5 text-sm text-slate-700 shadow-[0_18px_45px_rgba(15,23,42,0.06)] ring-1 ring-slate-100",children:[e.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-[0.18em] text-slate-500",children:"Quick actions"}),e.jsx("p",{className:"mb-3 text-xs text-slate-600",children:"Clear your feed in a couple of focused passes. Mini-Books keeps it fun and lightweight."}),e.jsxs("div",{className:"grid gap-3 text-[11px] sm:grid-cols-3",children:[e.jsxs("button",{className:"rounded-2xl bg-slate-50 px-3 py-2 text-left font-medium text-slate-800 hover:bg-slate-100",children:[e.jsx("div",{className:"mb-1 text-[11px] uppercase tracking-[0.14em] text-slate-400",children:"1. Import"}),e.jsx("div",{children:"Drop in your latest CSV statements."})]}),e.jsxs("button",{className:"rounded-2xl bg-slate-50 px-3 py-2 text-left font-medium text-slate-800 hover:bg-slate-100",children:[e.jsx("div",{className:"mb-1 text-[11px] uppercase tracking-[0.14em] text-slate-400",children:"2. Review"}),e.jsx("div",{children:"Match deposits & withdrawals in one place."})]}),e.jsxs("button",{className:"rounded-2xl bg-slate-50 px-3 py-2 text-left font-medium text-slate-800 hover:bg-slate-100",children:[e.jsx("div",{className:"mb-1 text-[11px] uppercase tracking-[0.14em] text-slate-400",children:"3. Done"}),e.jsx("div",{children:"See Profit & Loss update instantly."})]})]})]}),A=({reviewUrl:t,importUrl:s})=>{const[n,l]=d.useState([]),[x,p]=d.useState(null),[h,u]=d.useState(!0),[o,g]=d.useState(null);return d.useEffect(()=>{let i=!0;async function f(){try{const r=await fetch("/api/banking/overview/",{credentials:"same-origin"});if(!r.ok)throw new Error("Unable to load banking overview.");const m=await r.json();if(!i)return;const b=(m.accounts||[]).map(a=>({id:a.id,name:a.name,last4:a.last4||"",bank:a.bank||"",currency:a.currency||"",ledgerLinked:!!a.ledger_linked,ledgerBalance:a.ledger_balance||"0",feedStatus:a.feed_status||"OK",lastImportAt:a.last_import_at||null,newCount:a.new_count||0,createdCount:a.created_count||0,matchedCount:a.matched_count||0}));l(b),p(m.summary||null)}catch(r){i&&g(r instanceof Error?r.message:"Failed to load data.")}finally{i&&u(!1)}}return f(),()=>{i=!1}},[]),h?e.jsx("div",{className:"min-h-screen bg-slate-50 text-slate-900 font-sans",children:e.jsx("div",{className:"mx-auto max-w-6xl px-6 py-8",children:e.jsx("p",{className:"text-sm text-slate-500",children:"Loading banking overview…"})})}):o?e.jsx("div",{className:"min-h-screen bg-slate-50 text-slate-900 font-sans",children:e.jsx("div",{className:"mx-auto max-w-6xl px-6 py-8",children:e.jsx("p",{className:"text-sm text-rose-600",children:o})})}):e.jsx("div",{className:"min-h-screen bg-slate-50 text-slate-900 font-sans",children:e.jsxs("div",{className:"mx-auto max-w-6xl px-6 py-8",children:[e.jsxs("header",{className:"mb-6 flex flex-col gap-4 sm:flex-row sm:items-start sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-[11px] font-semibold uppercase tracking-[0.18em] text-slate-400",children:"BANKING"}),e.jsx("h1",{className:"mb-1 text-2xl font-semibold tracking-tight text-slate-900",children:"Bank accounts & feed"}),e.jsx("p",{className:"max-w-xl text-sm text-slate-500",children:"Connect accounts, import statements, and keep your bank feed tidy. Once reconciled, your ledger, Profit & Loss, and tax reports stay perfectly in sync."})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("a",{href:"/bank-accounts/new/",className:"inline-flex items-center rounded-full bg-slate-900 px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-black",children:"+ Add bank account"}),e.jsx("a",{href:s,className:"inline-flex items-center rounded-full bg-white px-4 py-1.5 text-xs font-semibold text-slate-700 ring-1 ring-slate-200 shadow-sm hover:bg-slate-50",children:"Import CSV"})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,2.3fr)_minmax(0,2fr)]",children:[e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-[11px] text-slate-500",children:[e.jsx("span",{className:"font-semibold uppercase tracking-[0.16em] text-slate-400",children:"Connected accounts"}),e.jsxs("span",{children:[n.length," active"]})]}),n.length===0?e.jsx("div",{className:"rounded-2xl border border-dashed border-slate-200 bg-white px-4 py-6 text-center text-sm text-slate-500",children:"No bank accounts yet. Add your first account to start reconciling."}):n.map(i=>e.jsx(y,{account:i,importUrl:s,reviewUrl:t},i.id))]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx(_,{summary:x}),e.jsx(S,{}),e.jsx(C,{})]})]})]})})},c=document.getElementById("banking-accounts-feed-root");if(c){const t=c.dataset.reviewUrl||"/bank-feeds/",s=c.dataset.importUrl||"/bank-feeds/new/";j.createRoot(c).render(e.jsx(N.StrictMode,{children:e.jsx(A,{reviewUrl:t,importUrl:s})}))}
